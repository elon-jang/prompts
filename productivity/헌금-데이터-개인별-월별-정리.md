# 헌금 데이터 개인별 월별 정리

## Description

교회 헌금 데이터를 개인별/월별로 정리하는 엑셀 생성 프롬프트

## Tags

church, excel, data-processing, automation, interactive

## Usage

1. 헌금 데이터 파일 준비
2. 프롬프트 실행
3. AI의 질문에 답변하며 데이터 정제
4. 최종 엑셀 파일 확인

## Prompt

````
@[헌금데이터파일] 파일을 분석해서 개인별 월별 헌금 총합을 정리하는 엑셀을 만들어줘.

## 진행 단계

### 1단계: 파일 분석
- 파일 형식(인코딩, 구분자) 파악
- 컬럼 구조 확인 (날짜, 이름, 금액 위치)
- 불명확하면 사용자에게 질문

### 2단계: 제외 항목 확인
비개인 항목 후보를 찾아서 사용자에게 확인:
- 단체명으로 보이는 항목
- 숫자만 있는 항목
- 빈 이름
- 기타 특수 항목

후보 목록을 보여주고 "이 항목들을 제외할까요?" 질문

### 3단계: 유사 이름 확인
유사한 이름 쌍을 찾아서 하나씩 사용자에게 확인:
- 편집 거리가 가까운 이름
- 구분자만 다른 이름 (콤마/마침표)
- 순서만 다른 이름 (A,B vs B,A)

각 쌍마다 "같은 사람인가요? 통합할까요?" 질문

### 4단계: 집계 및 엑셀 생성
- 확인된 규칙 적용
- 개인별 월별 집계
- 이름 가나다순 정렬
- 월별/연간 합계 행 추가

### 5단계: 검증
- 원본 총액 계산
- 제외 항목 총액 계산
- 최종 총액 = 원본 - 제외 확인
- 불일치 시 원인 파악

## 출력 형식

**파일명**: `[연도]_헌금_개인별정리.xlsx`

| 이름 | 1월 | 2월 | ... | 12월 | 연간 총합 |
|------|-----|-----|-----|------|----------|
| 홍길동 | 50,000 | 30,000 | ... | 20,000 | 350,000 |
| ... | ... | ... | ... | ... | ... |
| **합계** | **xxx** | **xxx** | ... | **xxx** | **xxx** |
````

---

## 사례: OO교회 2025년

실제 사용 사례입니다. 참고용으로 활용하세요.

### 파일 형식

| 항목 | 값 |
|------|-----|
| 인코딩 | UTF-16 Little Endian |
| 구분자 | 탭(\t) |
| 확장자 | .xls (실제는 텍스트) |

### 컬럼 구조

| Index | 내용 |
|-------|------|
| 0 | 날짜 (YYYY-MM-DD) |
| 4 | 이름/단체명 |
| 6 | 금액 |

### 제외 항목

| 패턴 | 예시 | 사유 |
|------|------|------|
| ~셀 | 8셀, 12셀 | 소그룹 단체 |
| 무명 | 무명 | 익명 헌금 |
| 숫자만 | 123 | 잘못된 입력 |

### 이름 통합 사례

**구분자 차이**
```
민경우.차성미 → 민경우,차성미
박경은.이은순 → 박경은,이은순
```

**오타 수정**
```
박은주,정평화 → 방은주,정평화 (박→방)
박래수,촹덕현 → 박내수,황덕현 (래→내, 촹→황)
고동안 → 고동완 (안→완)
```

**부부 이름 통합**
```
정일구 → 정일구,양지연
강신애 → 강신애,최정호
```

### 결과 요약

| 항목 | 값 |
|------|-----|
| 원본 총액 | 33,000,000원 |
| 제외 금액 | 120,000원 |
| 개인 총액 | 32,880,000원 |
| 개인 수 | 66명 |
