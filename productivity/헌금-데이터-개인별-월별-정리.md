# 헌금 데이터 개인별 월별 정리

## Description

교회 헌금 데이터를 개인별/월별로 정리하는 엑셀 생성 프롬프트

## Tags

church, excel, data-processing, automation

## Usage

1. 헌금 데이터 파일(.xls) 준비
2. 이름 통합 매핑 확인 및 업데이트
3. 프롬프트 실행하여 정리된 엑셀 생성

## Prompt

````
## 작업 요청 프롬프트

```
@[파일명].xls 파일을 이용해서 개인별 월별 총합, 1년 총합을 정리하는 엑셀을 만들어줘.

조건:
1. 개인 헌금만 포함 (단체/비개인 제외)
2. 유사한 이름은 통합 (오타, 구분자 차이 등)
3. 총액 검증 필요

제외 대상:
- ~셀 (예: 8셀)
- 무명
- 숫자만 있는 이름

이름 통합 규칙:
- 콤마(,)와 마침표(.) 구분자 → 콤마로 통일
- 오타 수정 (아래 매핑 참고)
```

---

## 원본 파일 형식

| 항목 | 설명 |
|------|------|
| 파일 형식 | UTF-16 LE, 탭 구분 텍스트 (.xls 확장자) |
| 인코딩 | UTF-16 Little Endian |
| 구분자 | 탭(\t) |

### 컬럼 구조
| Index | 내용 |
|-------|------|
| 0 | 날짜 (YYYY-MM-DD) |
| 4 | 이름/단체명 |
| 6 | 금액 |

---

## 제외 규칙

```python
def is_group(name):
    # 빈 이름
    if not name:
        return True
    # 숫자만 있는 경우
    if re.match(r'^\d+$', name):
        return True
    # ~셀로 끝나는 경우
    if re.search(r'셀$', name):
        return True
    # 비개인 항목
    if name in ['무명']:
        return True
    return False
```

---

## 이름 통합 매핑 (2025년 기준)

```python
name_mapping = {
    # 구분자 통일 (. → ,)
    '민경우.차성미': '민경우,차성미',
    '박경은.이은순': '박경은,이은순',
    '심재기.이명옥': '심재기,이명옥',
    '정상영.박명순': '정상영,박명순',
    '방은주.정평화': '방은주,정평화',

    # 오타 수정
    '박은주,정평화': '방은주,정평화',
    '박래수,촹덕현': '박내수,황덕현',
    '박래수,황덕현': '박내수,황덕현',
    '박성식,류재이': '박성식,류재리',
    '박성식,류재희': '박성식,류재리',

    # 정일구 그룹
    '정일구': '정일구,양지연',
    '정일구(양지원)': '정일구,양지연',
    '정일수,양지연': '정일구,양지연',

    # 강신애 그룹
    '강신애': '강신애,최정호',
    '최정호,강신애': '강신애,최정호',

    # 기타 통합
    '고동안': '고동완',
    '김창금': '김창근',
    '유혜영': '유혜정',
    '정진수': '정진수,김민정',
}
```

---

## 출력 파일 형식

**파일명**: `[연도]_income_summary.xlsx`

### 시트 구조: 개인별 월별 총합

| 이름 | 1월 | 2월 | ... | 12월 | 연간 총합 |
|------|-----|-----|-----|------|----------|
| 강신애,최정호 | 50,000 | 30,000 | ... | 20,000 | 350,000 |
| ... | ... | ... | ... | ... | ... |
| **합계** | **xxx** | **xxx** | ... | **xxx** | **32,880,000** |

- 이름: 가나다순 정렬
- 금액: 천 단위 콤마 포맷
- 마지막 행: 월별/연간 합계

---

## 검증 체크리스트

- [ ] 원본 파일 총액 확인 (예: 3,300만원)
- [ ] 제외 항목 금액 확인 (예: 8셀 10만원 + 무명 2만원 = 12만원)
- [ ] 최종 총액 = 원본 - 제외 (예: 3,300만원 - 12만원 = 3,288만원)
- [ ] 유사 이름 통합 확인 (중복 없는지)

---

## 새 연도 작업 시 추가 확인 사항

1. **새로운 유사 이름 확인**: 유사도 검사로 새 오타/변형 찾기
2. **새로운 비개인 항목 확인**: 단체명, 특수 항목 등
3. **이름 통합 매핑 업데이트**: 새로운 오타 패턴 추가

---

## 2025년 결과 요약

| 항목 | 값 |
|------|-----|
| 원본 총액 | 33,000,000원 |
| 제외 금액 | 120,000원 |
| 개인 총액 | 32,880,000원 |
| 개인 수 | 66명 |
````
